"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1688],{6591:(e,s,l)=>{l.r(s),l.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>a,metadata:()=>n,toc:()=>r});const n=JSON.parse('{"id":"command/\u9632\u706b\u5899/iptables","title":"iptables","description":"\u7ecf\u5178\u9632\u706b\u5899\uff08\u6b63\u5728\u88ab\u66ff\u4ee3\uff09","source":"@site/docs/02-command/90-\u9632\u706b\u5899/iptables.md","sourceDirName":"02-command/90-\u9632\u706b\u5899","slug":"/command/\u9632\u706b\u5899/iptables","permalink":"/command/\u9632\u706b\u5899/iptables","draft":false,"unlisted":false,"editUrl":"https://github.com/zxzsk/linux-cmd/docs/02-command/90-\u9632\u706b\u5899/iptables.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"gpg","permalink":"/command/\u9632\u706b\u5899/gpg"},"next":{"title":"nftables","permalink":"/command/\u9632\u706b\u5899/nftables"}}');var i=l(4848),d=l(8453);const a={},t=void 0,c={},r=[{value:"1. \u4ec0\u4e48\u662f iptables\uff1f \ud83e\udd14",id:"1-\u4ec0\u4e48\u662f-iptables-",level:2},{value:"2. \u5b89\u88c5 iptables \ud83d\udce5",id:"2-\u5b89\u88c5-iptables-",level:2},{value:"2.1 \u5b89\u88c5 iptables",id:"21-\u5b89\u88c5-iptables",level:3},{value:"2.2 \u68c0\u67e5 iptables \u72b6\u6001",id:"22-\u68c0\u67e5-iptables-\u72b6\u6001",level:3},{value:"3. \u914d\u7f6e iptables \u9632\u706b\u5899 \u2699\ufe0f",id:"3-\u914d\u7f6e-iptables-\u9632\u706b\u5899-\ufe0f",level:2},{value:"3.1 \u57fa\u672c\u547d\u4ee4\u683c\u5f0f",id:"31-\u57fa\u672c\u547d\u4ee4\u683c\u5f0f",level:3},{value:"3.2 \u914d\u7f6e\u5e38\u89c1\u7684\u9632\u706b\u5899\u89c4\u5219",id:"32-\u914d\u7f6e\u5e38\u89c1\u7684\u9632\u706b\u5899\u89c4\u5219",level:3},{value:"3.2.1 \u5141\u8bb8 SSH \u8bbf\u95ee",id:"321-\u5141\u8bb8-ssh-\u8bbf\u95ee",level:4},{value:"3.2.2 \u5141\u8bb8 HTTP \u548c HTTPS \u8bbf\u95ee",id:"322-\u5141\u8bb8-http-\u548c-https-\u8bbf\u95ee",level:4},{value:"3.2.3 \u62d2\u7edd ICMP\uff08Ping\uff09\u8bf7\u6c42",id:"323-\u62d2\u7edd-icmpping\u8bf7\u6c42",level:4},{value:"3.2.4 \u5141\u8bb8\u6765\u81ea\u7279\u5b9a IP \u5730\u5740\u7684\u6d41\u91cf",id:"324-\u5141\u8bb8\u6765\u81ea\u7279\u5b9a-ip-\u5730\u5740\u7684\u6d41\u91cf",level:4},{value:"3.2.5 \u9ed8\u8ba4\u62d2\u7edd\u6240\u6709\u6d41\u91cf",id:"325-\u9ed8\u8ba4\u62d2\u7edd\u6240\u6709\u6d41\u91cf",level:4},{value:"3.3 \u914d\u7f6e\u89c4\u5219\u94fe",id:"33-\u914d\u7f6e\u89c4\u5219\u94fe",level:3},{value:"4. \u4fdd\u5b58\u548c\u6062\u590d iptables \u89c4\u5219 \ud83d\udd27",id:"4-\u4fdd\u5b58\u548c\u6062\u590d-iptables-\u89c4\u5219-",level:2},{value:"4.1 \u4fdd\u5b58\u89c4\u5219",id:"41-\u4fdd\u5b58\u89c4\u5219",level:3},{value:"4.2 \u6062\u590d\u89c4\u5219",id:"42-\u6062\u590d\u89c4\u5219",level:3},{value:"5. \u914d\u7f6e\u9632\u706b\u5899\u5f00\u673a\u81ea\u542f \u26a1",id:"5-\u914d\u7f6e\u9632\u706b\u5899\u5f00\u673a\u81ea\u542f-",level:2},{value:"5.1 \u542f\u52a8 iptables \u5f00\u673a\u81ea\u542f",id:"51-\u542f\u52a8-iptables-\u5f00\u673a\u81ea\u542f",level:3},{value:"5.2 \u786e\u4fdd iptables \u670d\u52a1\u6b63\u5728\u8fd0\u884c",id:"52-\u786e\u4fdd-iptables-\u670d\u52a1\u6b63\u5728\u8fd0\u884c",level:3},{value:"6. \u67e5\u770b\u548c\u8c03\u8bd5 iptables \u89c4\u5219 \ud83d\udee0\ufe0f",id:"6-\u67e5\u770b\u548c\u8c03\u8bd5-iptables-\u89c4\u5219-\ufe0f",level:2},{value:"6.1 \u67e5\u770b\u73b0\u6709\u89c4\u5219",id:"61-\u67e5\u770b\u73b0\u6709\u89c4\u5219",level:3},{value:"6.2 \u67e5\u770b NAT \u8868\u89c4\u5219",id:"62-\u67e5\u770b-nat-\u8868\u89c4\u5219",level:3},{value:"6.3 \u542f\u7528\u65e5\u5fd7\u8bb0\u5f55",id:"63-\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55",level:3},{value:"7. \u9ad8\u7ea7 iptables \u914d\u7f6e \ud83c\udf10",id:"7-\u9ad8\u7ea7-iptables-\u914d\u7f6e-",level:2},{value:"7.1 \u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1",id:"71-\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1",level:3},{value:"7.2 \u914d\u7f6e\u72b6\u6001\u8ddf\u8e2a",id:"72-\u914d\u7f6e\u72b6\u6001\u8ddf\u8e2a",level:3},{value:"7.3 \u9650\u5236\u8fde\u63a5\u901f\u7387",id:"73-\u9650\u5236\u8fde\u63a5\u901f\u7387",level:3},{value:"8. \u5c0f\u7ed3 \ud83c\udf89",id:"8-\u5c0f\u7ed3-",level:2}];function h(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:"\u7ecf\u5178\u9632\u706b\u5899\uff08\u6b63\u5728\u88ab\u66ff\u4ee3\uff09"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"iptables"})," \u662f Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6700\u5e38\u7528\u7684\u9632\u706b\u5899\u5de5\u5177\u3002"]}),"\n",(0,i.jsx)(s.h2,{id:"1-\u4ec0\u4e48\u662f-iptables-",children:"1. \u4ec0\u4e48\u662f iptables\uff1f \ud83e\udd14"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"iptables"})," \u662f Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6700\u5e38\u7528\u7684\u9632\u706b\u5899\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u8fc7\u6ee4\u548c\u7ba1\u7406\u7f51\u7edc\u6d41\u91cf\u3002iptables \u57fa\u4e8e\u89c4\u5219\u96c6\u6765\u63a7\u5236\u8fdb\u51fa Linux \u7cfb\u7edf\u7684\u7f51\u7edc\u6d41\u91cf\u3002\u5b83\u80fd\u591f\u6839\u636e IP \u5730\u5740\u3001\u7aef\u53e3\u3001\u534f\u8bae\u7b49\u6761\u4ef6\u8fc7\u6ee4\u6570\u636e\u5305\uff0c\u5e76\u4e3a\u7cfb\u7edf\u63d0\u4f9b\u5f3a\u5927\u7684\u5b89\u5168\u6027\u4fdd\u62a4\u3002\ud83d\ude80"]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"\u7279\u70b9"}),(0,i.jsx)(s.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"\u9ad8\u5ea6\u53ef\u5b9a\u5236"}),(0,i.jsx)(s.td,{children:"\u5141\u8bb8\u6839\u636e\u4e0d\u540c\u7684\u7f51\u7edc\u9700\u6c42\u548c\u5b89\u5168\u7b56\u7565\u6765\u5b9a\u5236\u89c4\u5219\u3002"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"\u6027\u80fd\u9ad8\u6548"}),(0,i.jsx)(s.td,{children:"\u76f4\u63a5\u64cd\u4f5c\u5185\u6838\u7684\u7f51\u7edc\u6808\uff0c\u5177\u6709\u6781\u4f4e\u7684\u6027\u80fd\u5f00\u9500\u3002"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"\u5f3a\u5927\u7684\u89c4\u5219\u652f\u6301"}),(0,i.jsx)(s.td,{children:"\u652f\u6301\u591a\u79cd\u534f\u8bae\uff08TCP\u3001UDP\u3001ICMP \u7b49\uff09\u548c\u5404\u79cd\u7f51\u7edc\u5c42\u8fc7\u6ee4\u3002"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"2-\u5b89\u88c5-iptables-",children:"2. \u5b89\u88c5 iptables \ud83d\udce5"}),"\n",(0,i.jsx)(s.h3,{id:"21-\u5b89\u88c5-iptables",children:"2.1 \u5b89\u88c5 iptables"}),"\n",(0,i.jsx)(s.p,{children:"\u5728\u5927\u591a\u6570 Linux \u53d1\u884c\u7248\u4e2d\uff0ciptables \u901a\u5e38\u662f\u9884\u88c5\u7684\u3002\u5982\u679c\u6ca1\u6709\u5b89\u88c5\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u5b83\uff1a"}),"\n",(0,i.jsx)(s.p,{children:"\u5728 Ubuntu \u6216 Debian \u7cfb\u7edf\u4e0a\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo apt update\r\nsudo apt install iptables\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u5728 CentOS \u6216 RHEL \u7cfb\u7edf\u4e0a\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo yum install iptables\n"})}),"\n",(0,i.jsx)(s.h3,{id:"22-\u68c0\u67e5-iptables-\u72b6\u6001",children:"2.2 \u68c0\u67e5 iptables \u72b6\u6001"}),"\n",(0,i.jsx)(s.p,{children:"\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5 iptables \u670d\u52a1\u7684\u72b6\u6001\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl status iptables\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u5982\u679c\u6ca1\u6709\u5b89\u88c5\u6216\u672a\u542f\u7528\uff0c\u4f60\u53ef\u4ee5\u542f\u52a8 iptables \u670d\u52a1\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl start iptables\n"})}),"\n",(0,i.jsx)(s.h2,{id:"3-\u914d\u7f6e-iptables-\u9632\u706b\u5899-\ufe0f",children:"3. \u914d\u7f6e iptables \u9632\u706b\u5899 \u2699\ufe0f"}),"\n",(0,i.jsx)(s.h3,{id:"31-\u57fa\u672c\u547d\u4ee4\u683c\u5f0f",children:"3.1 \u57fa\u672c\u547d\u4ee4\u683c\u5f0f"}),"\n",(0,i.jsx)(s.p,{children:"iptables \u7684\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A <CHAIN> -p <PROTOCOL> --dport <PORT> -j <ACTION>\n"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"-A"}),": \u6dfb\u52a0\u89c4\u5219\uff08Append\uff09\u3002"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"-p"}),": \u6307\u5b9a\u534f\u8bae\uff0c\u5982 ",(0,i.jsx)(s.code,{children:"tcp"}),"\u3001",(0,i.jsx)(s.code,{children:"udp"})," \u6216 ",(0,i.jsx)(s.code,{children:"icmp"}),"\u3002"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"--dport"}),": \u76ee\u6807\u7aef\u53e3\u3002"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"-j"}),": \u6307\u5b9a\u52a8\u4f5c\uff08\u5982 ACCEPT\u3001DROP\u3001REJECT \u7b49\uff09\u3002"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"32-\u914d\u7f6e\u5e38\u89c1\u7684\u9632\u706b\u5899\u89c4\u5219",children:"3.2 \u914d\u7f6e\u5e38\u89c1\u7684\u9632\u706b\u5899\u89c4\u5219"}),"\n",(0,i.jsx)(s.h4,{id:"321-\u5141\u8bb8-ssh-\u8bbf\u95ee",children:"3.2.1 \u5141\u8bb8 SSH \u8bbf\u95ee"}),"\n",(0,i.jsx)(s.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLinux \u9632\u706b\u5899\u4f1a\u963b\u6b62\u6240\u6709\u4f20\u5165\u7684\u8fde\u63a5\u3002\u8981\u5141\u8bb8 SSH\uff08\u7aef\u53e3 22\uff09\u7684\u8fde\u63a5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT\n"})}),"\n",(0,i.jsx)(s.h4,{id:"322-\u5141\u8bb8-http-\u548c-https-\u8bbf\u95ee",children:"3.2.2 \u5141\u8bb8 HTTP \u548c HTTPS \u8bbf\u95ee"}),"\n",(0,i.jsx)(s.p,{children:"\u8981\u5141\u8bb8 HTTP\uff08\u7aef\u53e3 80\uff09\u548c HTTPS\uff08\u7aef\u53e3 443\uff09\u7684\u8bbf\u95ee\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\r\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\n"})}),"\n",(0,i.jsx)(s.h4,{id:"323-\u62d2\u7edd-icmpping\u8bf7\u6c42",children:"3.2.3 \u62d2\u7edd ICMP\uff08Ping\uff09\u8bf7\u6c42"}),"\n",(0,i.jsx)(s.p,{children:"\u4e3a\u4e86\u589e\u5f3a\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u53ef\u80fd\u9700\u8981\u7981\u7528 Ping \u8bf7\u6c42\uff08ICMP\uff09\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u62d2\u7edd\u6240\u6709\u4f20\u5165\u7684 ICMP \u8bf7\u6c42\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A INPUT -p icmp --icmp-type echo-request -j REJECT\n"})}),"\n",(0,i.jsx)(s.h4,{id:"324-\u5141\u8bb8\u6765\u81ea\u7279\u5b9a-ip-\u5730\u5740\u7684\u6d41\u91cf",children:"3.2.4 \u5141\u8bb8\u6765\u81ea\u7279\u5b9a IP \u5730\u5740\u7684\u6d41\u91cf"}),"\n",(0,i.jsx)(s.p,{children:"\u5982\u679c\u4f60\u5e0c\u671b\u53ea\u5141\u8bb8\u6765\u81ea\u7279\u5b9a IP \u5730\u5740\u7684\u8bbf\u95ee\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A INPUT -p tcp -s 192.168.1.100 --dport 22 -j ACCEPT\n"})}),"\n",(0,i.jsx)(s.h4,{id:"325-\u9ed8\u8ba4\u62d2\u7edd\u6240\u6709\u6d41\u91cf",children:"3.2.5 \u9ed8\u8ba4\u62d2\u7edd\u6240\u6709\u6d41\u91cf"}),"\n",(0,i.jsx)(s.p,{children:"\u4e3a\u4e86\u63d0\u9ad8\u5b89\u5168\u6027\uff0c\u5efa\u8bae\u8bbe\u7f6e\u9ed8\u8ba4\u89c4\u5219\u4e3a\u62d2\u7edd\u6240\u6709\u4f20\u5165\u8fde\u63a5\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -P INPUT DROP\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u8fd9\u5c06\u963b\u6b62\u6240\u6709\u672a\u660e\u786e\u5141\u8bb8\u7684\u6d41\u91cf\u3002"}),"\n",(0,i.jsx)(s.h3,{id:"33-\u914d\u7f6e\u89c4\u5219\u94fe",children:"3.3 \u914d\u7f6e\u89c4\u5219\u94fe"}),"\n",(0,i.jsx)(s.p,{children:"iptables \u4f7f\u7528\u89c4\u5219\u94fe\uff08Chain\uff09\u6765\u7ec4\u7ec7\u4e0d\u540c\u7684\u89c4\u5219\u3002\u5e38\u89c1\u7684\u89c4\u5219\u94fe\u6709\uff1a"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"INPUT"}),"\uff1a\u5904\u7406\u8fdb\u5165\u7cfb\u7edf\u7684\u6d41\u91cf\u3002"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"OUTPUT"}),"\uff1a\u5904\u7406\u4ece\u7cfb\u7edf\u53d1\u51fa\u7684\u6d41\u91cf\u3002"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"FORWARD"}),"\uff1a\u5904\u7406\u8f6c\u53d1\u6d41\u91cf\u3002"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u5f53\u524d\u89c4\u5219\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -L\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u5982\u679c\u60f3\u8981\u5220\u9664\u67d0\u6761\u89c4\u5219\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -D INPUT -p tcp --dport 22 -j ACCEPT\n"})}),"\n",(0,i.jsx)(s.h2,{id:"4-\u4fdd\u5b58\u548c\u6062\u590d-iptables-\u89c4\u5219-",children:"4. \u4fdd\u5b58\u548c\u6062\u590d iptables \u89c4\u5219 \ud83d\udd27"}),"\n",(0,i.jsx)(s.h3,{id:"41-\u4fdd\u5b58\u89c4\u5219",children:"4.1 \u4fdd\u5b58\u89c4\u5219"}),"\n",(0,i.jsx)(s.p,{children:"\u5728\u7cfb\u7edf\u91cd\u542f\u540e\uff0ciptables \u914d\u7f6e\u4f1a\u4e22\u5931\u3002\u56e0\u6b64\uff0c\u5fc5\u987b\u4fdd\u5b58\u89c4\u5219\uff1a"}),"\n",(0,i.jsx)(s.p,{children:"\u5728 Ubuntu \u6216 Debian \u7cfb\u7edf\u4e0a\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables-save > /etc/iptables/rules.v4\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u5728 CentOS \u6216 RHEL \u7cfb\u7edf\u4e0a\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo service iptables save\n"})}),"\n",(0,i.jsx)(s.h3,{id:"42-\u6062\u590d\u89c4\u5219",children:"4.2 \u6062\u590d\u89c4\u5219"}),"\n",(0,i.jsx)(s.p,{children:"\u5982\u679c\u4f60\u9700\u8981\u6062\u590d\u4fdd\u5b58\u7684\u89c4\u5219\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(s.p,{children:"\u5728 Ubuntu \u6216 Debian \u7cfb\u7edf\u4e0a\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables-restore < /etc/iptables/rules.v4\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u5728 CentOS \u6216 RHEL \u7cfb\u7edf\u4e0a\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo service iptables restart\n"})}),"\n",(0,i.jsx)(s.h2,{id:"5-\u914d\u7f6e\u9632\u706b\u5899\u5f00\u673a\u81ea\u542f-",children:"5. \u914d\u7f6e\u9632\u706b\u5899\u5f00\u673a\u81ea\u542f \u26a1"}),"\n",(0,i.jsx)(s.h3,{id:"51-\u542f\u52a8-iptables-\u5f00\u673a\u81ea\u542f",children:"5.1 \u542f\u52a8 iptables \u5f00\u673a\u81ea\u542f"}),"\n",(0,i.jsx)(s.p,{children:"\u4e3a\u4e86\u786e\u4fdd\u7cfb\u7edf\u91cd\u542f\u540e iptables \u81ea\u52a8\u542f\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl enable iptables\n"})}),"\n",(0,i.jsx)(s.h3,{id:"52-\u786e\u4fdd-iptables-\u670d\u52a1\u6b63\u5728\u8fd0\u884c",children:"5.2 \u786e\u4fdd iptables \u670d\u52a1\u6b63\u5728\u8fd0\u884c"}),"\n",(0,i.jsx)(s.p,{children:"\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u786e\u4fdd iptables \u670d\u52a1\u6b63\u5728\u8fd0\u884c\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo systemctl start iptables\n"})}),"\n",(0,i.jsx)(s.h2,{id:"6-\u67e5\u770b\u548c\u8c03\u8bd5-iptables-\u89c4\u5219-\ufe0f",children:"6. \u67e5\u770b\u548c\u8c03\u8bd5 iptables \u89c4\u5219 \ud83d\udee0\ufe0f"}),"\n",(0,i.jsx)(s.h3,{id:"61-\u67e5\u770b\u73b0\u6709\u89c4\u5219",children:"6.1 \u67e5\u770b\u73b0\u6709\u89c4\u5219"}),"\n",(0,i.jsx)(s.p,{children:"\u8981\u67e5\u770b\u5f53\u524d\u7684\u6240\u6709 iptables \u89c4\u5219\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -L -v\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u8be5\u547d\u4ee4\u4f1a\u5217\u51fa\u6240\u6709\u89c4\u5219\uff0c\u5e76\u663e\u793a\u8be6\u7ec6\u7684\u6d41\u91cf\u8ba1\u6570\u4fe1\u606f\u3002"}),"\n",(0,i.jsx)(s.h3,{id:"62-\u67e5\u770b-nat-\u8868\u89c4\u5219",children:"6.2 \u67e5\u770b NAT \u8868\u89c4\u5219"}),"\n",(0,i.jsx)(s.p,{children:"\u5982\u679c\u4f60\u914d\u7f6e\u4e86 NAT\uff08\u4f8b\u5982\u7aef\u53e3\u8f6c\u53d1\uff09\uff0c\u53ef\u4ee5\u67e5\u770b NAT \u8868\u89c4\u5219\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -t nat -L -v\n"})}),"\n",(0,i.jsx)(s.h3,{id:"63-\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55",children:"6.3 \u542f\u7528\u65e5\u5fd7\u8bb0\u5f55"}),"\n",(0,i.jsx)(s.p,{children:"\u4f60\u53ef\u4ee5\u4f7f\u7528 iptables \u8fdb\u884c\u65e5\u5fd7\u8bb0\u5f55\uff0c\u4f8b\u5982\u8bb0\u5f55\u88ab\u62d2\u7edd\u7684\u8fde\u63a5\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'sudo iptables -A INPUT -j LOG --log-prefix "iptables denied: "\n'})}),"\n",(0,i.jsxs)(s.p,{children:["\u65e5\u5fd7\u4f1a\u5199\u5165 ",(0,i.jsx)(s.code,{children:"/var/log/syslog"}),"\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b\u88ab\u62d2\u7edd\u7684\u8fde\u63a5\u3002"]}),"\n",(0,i.jsx)(s.h2,{id:"7-\u9ad8\u7ea7-iptables-\u914d\u7f6e-",children:"7. \u9ad8\u7ea7 iptables \u914d\u7f6e \ud83c\udf10"}),"\n",(0,i.jsx)(s.h3,{id:"71-\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1",children:"7.1 \u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1"}),"\n",(0,i.jsx)(s.p,{children:"\u5982\u679c\u4f60\u9700\u8981\u5c06\u5916\u90e8\u7684\u67d0\u4e2a\u7aef\u53e3\u6d41\u91cf\u8f6c\u53d1\u5230\u5185\u90e8\u7684\u53e6\u4e00\u4e2a\u7aef\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(s.p,{children:"\u4f8b\u5982\uff0c\u5c06\u6240\u6709\u6765\u81ea\u5916\u90e8\u7aef\u53e3 8080 \u7684\u6d41\u91cf\u8f6c\u53d1\u5230\u5185\u90e8\u7aef\u53e3 80\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -t nat -A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-port 80\n"})}),"\n",(0,i.jsx)(s.h3,{id:"72-\u914d\u7f6e\u72b6\u6001\u8ddf\u8e2a",children:"7.2 \u914d\u7f6e\u72b6\u6001\u8ddf\u8e2a"}),"\n",(0,i.jsx)(s.p,{children:"iptables \u652f\u6301\u57fa\u4e8e\u8fde\u63a5\u72b6\u6001\u7684\u8fc7\u6ee4\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u4ec5\u5141\u8bb8\u5df2\u7ecf\u5efa\u7acb\u7684\u8fde\u63a5\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n"})}),"\n",(0,i.jsx)(s.h3,{id:"73-\u9650\u5236\u8fde\u63a5\u901f\u7387",children:"7.3 \u9650\u5236\u8fde\u63a5\u901f\u7387"}),"\n",(0,i.jsx)(s.p,{children:"\u4e3a\u4e86\u9632\u6b62\u66b4\u529b\u7834\u89e3\uff0c\u53ef\u4ee5\u9650\u5236\u67d0\u4e9b\u670d\u52a1\u7684\u8fde\u63a5\u901f\u7387\uff0c\u4f8b\u5982\u9650\u5236 SSH \u6bcf\u79d2\u7684\u8fde\u63a5\u6b21\u6570\uff1a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo iptables -A INPUT -p tcp --dport 22 -m limit --limit 5/min -j ACCEPT\n"})}),"\n",(0,i.jsx)(s.h2,{id:"8-\u5c0f\u7ed3-",children:"8. \u5c0f\u7ed3 \ud83c\udf89"}),"\n",(0,i.jsxs)(s.p,{children:["\u901a\u8fc7\u672c\u6559\u7a0b\uff0c\u4f60\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u5b89\u88c5\u3001\u914d\u7f6e\u548c\u7ba1\u7406 iptables \u9632\u706b\u5899\uff0c\u589e\u5f3a\u4e86 Linux \u7cfb\u7edf\u7684\u5b89\u5168\u6027\u3002iptables \u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u80fd\u591f\u5e2e\u52a9\u4f60\u7cbe\u7ec6\u5730\u63a7\u5236\u6d41\u91cf\u3001\u63d0\u9ad8\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u3002\u5e0c\u671b\u8fd9\u7bc7\u6559\u7a0b\u5bf9\u4f60\u6709\u6240\u5e2e\u52a9\uff01\ud83d\ude80 \u522b\u5fd8\u4e86\u6536\u85cf ",(0,i.jsx)(s.strong,{children:"\u5728\u7ebf\u77e5\u8bc6\u5e93"}),"\uff08 ",(0,i.jsx)(s.a,{href:"http://www.zxzsk.com/",children:"www.zxzsk.com"})," \uff09\u54e6\uff01\ud83d\ude0a"]})]})}function p(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,s,l)=>{l.d(s,{R:()=>a,x:()=>t});var n=l(6540);const i={},d=n.createContext(i);function a(e){const s=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(d.Provider,{value:s},e.children)}}}]);