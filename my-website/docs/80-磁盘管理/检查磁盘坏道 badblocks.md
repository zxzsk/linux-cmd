---
slug: /linux-cmd-badblocks
---


`badblocks` 是 Linux 系统中的一个命令行工具，用于检测存储设备（如硬盘、SSD、U盘等）上的坏块（物理损坏的存储单元）。它能够帮助管理员识别并标记存储设备上的损坏部分，以避免数据写入这些区域。

以下是对 `badblocks` 命令的详细解析：

## 基本语法

```bash
badblocks [选项] 设备
```
- `设备`：需要检测的存储设备路径，例如 `/dev/sda`。

## 常用选项

### 1. **检测模式**
- `-n`：**非破坏性读写测试**。不会破坏磁盘上的数据，但可能耗时较长。
- `-w`：**破坏性读写测试**。会覆盖磁盘上的数据，彻底测试每个块。

### 2. **测试模式**
- `-t`：指定测试模式下的测试数据。例如 `-t 0xAA` 用 `0xAA` 测试每个块。

### 3. **读写类型**
- `-o 文件`：将检测到的坏块列表输出到文件中。
- `-v`：显示检测过程中的详细信息。
- `-s`：显示进度条。
- `-p 次数`：指定测试的重复次数。

### 4. **其他选项**
- `-b 块大小`：设置块大小（单位：字节）。默认是 1024 字节。
- `-c 块数`：每次读取的块数，用于提高检测效率。
- `-e 文件`：检测完成后，将坏块列表追加到指定文件中。

## 使用示例

### 1. **非破坏性检测（安全，不影响数据）**
```bash
sudo badblocks -nsv /dev/sda
```
- `-n`：非破坏性测试。
- `-s`：显示进度条。
- `-v`：显示详细信息。

![PixPin_2025-01-25_01-20-47](https://img.zxzsk.com/images/PixPin_2025-01-25_01-20-47.webp)

### 2. **破坏性检测（会清除设备数据）**

```bash
sudo badblocks -wsv /dev/sda
```
- `-w`：破坏性读写测试。
- ⚠️ **警告**：会清除存储设备上的所有数据，谨慎使用。

### 3. **输出坏块列表到文件**

```bash
sudo badblocks -nsv /dev/sda > badblocks.txt
```
- 将检测到的坏块信息保存到 `badblocks.txt` 文件中。

### 4. **与 `e2fsck` 或 `mkfs` 结合使用**
`badblocks` 的输出可以直接与文件系统工具配合使用。例如，在格式化文件系统时标记坏块：
```bash
sudo badblocks -sv /dev/sda > badblocks.txt
sudo e2fsck -l badblocks.txt /dev/sda1
```
- `e2fsck`：检查和修复文件系统，同时标记坏块。

## 注意事项

1. **备份数据**：在使用破坏性检测（`-w`）时，务必先备份数据。
2. **权限**：`badblocks` 需要管理员权限，通常需要通过 `sudo` 执行。
3. **设备路径**：确保提供正确的设备路径，误操作可能导致数据丢失。
4. **耗时长**：检测速度取决于设备容量和选项配置，大容量设备检测可能需要数小时。

## 检测模式对比

| 模式       | 特点                                   | 是否安全 |
|------------|----------------------------------------|----------|
| 非破坏性模式 (`-n`) | 不覆盖现有数据，测试时间较长         | 安全     |
| 破坏性模式 (`-w`)   | 会清除所有数据，全面读写检测         | 不安全   |

如果你有特定需求，可以提供更多背景，我可以进一步调整或细化操作！